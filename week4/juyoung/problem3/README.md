# 문제 개요

문제 : [행렬 제곱](https://www.acmicpc.net/problem/10830)

문제 분류 : 분할정복

# 문제 풀이

[다른 사람 풀이](https://cocoon1787.tistory.com/293)를 참고했다.

행렬을 제곱하는 방법 안에서 분할정복을 적용하는줄 알았는데,  
행렬을 제곱하는 횟수를 줄이기 위해 분할정복을 적용하는 거였다.

만약 행렬 `A`를 9번 제곱한다고 하면 아래와 같다.

- A^9 = (A^2 \* A^2) \* (A^2 \* A^2) \* A
- A^9 = A^4 \* A^4 \* A

그냥 행렬 제곱을 하는 함수를 9번 호출하여 제곱할 수도 있지만,  
문제에서 제곱하는 횟수 `B`가 최대 100,000,000,000이기 때문에 여기서 분할정복을 적용해야 한다.

따라서 아래 방법으로 풀 수 있다.  
초기에 행렬 `answer`는 단위 행렬이다.

1. `B`가 홀수이면 `answer`와 `A`를 곱하고, 이 값을 `answer`에 저장한다.
2. `A`를 제곱하고, 이를 `A`에 저장한다.
3. `B`를 2로 나눈다.

```cpp
while (B > 0) {
  if (B % 2 == 1)
    matrix_square(answer, A);
  matrix_square(A, A);
  B /= 2;
}
```

행렬을 곱하는 `matrix_square(mat1, mat2)`에서는 두 행렬을 곱한 후,  
`mat1`의 값을 곱한 행렬 값으로 업데이트 한다.

A^5로 다시 예를 들자면 아래와 같다.

```plain
A^5 = (A x A) x (A x A) x A
```

1. `B` = 5
   - 홀수니까 `answer`(현재 단위행렬)와 `A`를 곱함
     - `answer`에 A 저장됨
   - `A`에 A^2 저장됨
2. `B` = 2
   - `A`에 A^4 저장됨
3. `B` = 1
   - 홀수니까 `answer`(현재 A)와 `A`(현재 A^4)를 곱함
     - `answer`에 A^5 저장됨
